<!--
=========================================================
* Argon Dashboard - v1.2.0
=========================================================
* Product Page: https://www.creative-tim.com/product/argon-dashboard


* Copyright    Creative Tim (http://www.creative-tim.com)
* Coded by www.creative-tim.com



=========================================================
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="SkyID Dashboard">
	<meta name="author" content="DaWe35">
	<title>SkyID</title>
	<!-- Favicon -->
	<link rel="icon" href="assets/img/brand/SkyID_Logo_128.png" type="image/png">
	<!-- Fonts -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
	<!-- Icons -->
	<link rel="stylesheet" href="assets/vendor/nucleo/css/nucleo.css" type="text/css">
	<link rel="stylesheet" href="assets/vendor/@fortawesome/fontawesome-free/css/all.min.css" type="text/css">
	<!-- Page plugins -->
	<!-- Argon CSS -->
	<link rel="stylesheet" href="assets/css/argon.css?v=1.2.0" type="text/css">
</head>

<body class="bg-dark">
	<!-- Sidenav -->
	<nav class="sidenav navbar navbar-vertical    fixed-left    navbar-expand-xs navbar-light bg-darkish"
		id="sidenav-main">
		<div class="scrollbar-inner">
			<!-- Brand -->
			<div class="sidenav-header    align-items-center">
				<a class="navbar-brand" href="#profile" onmousedown="loadPage('#profile')">
					<img src="assets/img/brand/SkyID_Logo_128_white.png"
						style="filter: invert(27%) sepia(59%) saturate(2764%) hue-rotate(103deg) brightness(96%) contrast(80%);"
						class="navbar-brand-img" alt="...">
					<span class="ml-1 text-skygreenish">SkyID</span>
				</a>
			</div>
			<div class="navbar-inner">
				<!-- Collapse -->
				<div class="collapse navbar-collapse" id="sidenav-collapse-main">
					<!-- Nav items -->
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link text-secondary" href="#blog" onmousedown="loadPage('#blog')">
								<i class="fa fa-book text-skygreenish"></i>
								<span class="nav-link-text">Blog</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-secondary" href="#profile" onmousedown="loadPage('#profile')">
								<i class="ni ni-single-02 text-skygreenish"></i>
								<span class="nav-link-text">Profile</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-secondary" href="#dapps" onmousedown="loadPage('#dapps')">
								<i class="ni ni-app text-skygreenish"></i>
								<span class="nav-link-text">Dapps</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-secondary" href="#qr-login" onmousedown="loadPage('#qr-login')">
								<i class="fa fa-qrcode text-skygreenish"></i>
								<span class="nav-link-text">QR-Code</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-muted cursor-default" href="javascript:alert('soooooon')">
								<i class="ni ni-chart-bar-32 text-muted"></i>
								<span class="nav-link-text">Users</span>
							</a>
						</li>
					</ul>
					<!-- Divider -->
					<hr class="my-3">
					<!-- Heading -->
					<h6 class="navbar-heading p-0 text-muted">
						<span class="docs-normal">Documentation</span>
					</h6>
					<!-- Navigation -->
					<ul class="navbar-nav mb-md-3">
						<li class="nav-item">
							<a class="nav-link"
								href="https://blog.sia.tech/skyid-how-to-make-decentralized-identity-using-skynet-2b282682f5b3"
								target="_blank">
								<i class="ni ni-collection text-light"></i>
								<span class="nav-link-text text-light">Learn</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://github.com/DaWe35/SkyID#readme" target="_blank">
								<i class="fab fa-github text-light"></i>
								<span class="nav-link-text text-light">Implement</span>
							</a>
						</li>
						<!-- <li class="nav-item">
							<a class="nav-link active active-pro" href="upgrade.html">
								<i class="ni ni-send text-dark"></i>
								<span class="nav-link-text">Upgrade to PRO</span>
							</a>
						</li> -->
					</ul>
				</div>
			</div>
		</div>
	</nav>
	<!-- Main content -->
	<div class="main-content" id="panel">
		<!-- Topnav -->
		<nav class="navbar navbar-top navbar-expand navbar-dark bg-darkish">
			<div class="container-fluid">
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<!-- Navbar links -->
					<ul class="navbar-nav align-items-center ml-md-auto ml-auto">
						<li class="nav-item d-lg-none">
							<!-- Sidenav toggler -->
							<div class="pr-3 sidenav-toggler sidenav-toggler-dark" data-action="sidenav-pin"
								data-target="#sidenav-main">
								<div class="sidenav-toggler-inner">
									<i class="sidenav-toggler-line"></i>
									<i class="sidenav-toggler-line"></i>
									<i class="sidenav-toggler-line"></i>
								</div>
							</div>
						</li>
						<!-- <li class="nav-item dropdown">
							<a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								<i class="ni ni-bell-55"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-xl    dropdown-menu-right    py-0 overflow-hidden">
								<!-- Dropdown header --
								<div class="px-3 py-3">
									<h6 class="text-sm text-muted m-0">You have <strong class="text-primary">13</strong> notifications.</h6>
								</div>
								<!-- List group --
								<div class="list-group list-group-flush">
									<a href="#!" class="list-group-item list-group-item-action">
										<div class="row align-items-center">
											<div class="col-auto">
												<!-- Avatar --
												<img alt="Image placeholder" src="assets/img/theme/team-1.jpg" class="avatar rounded-circle">
											</div>
											<div class="col ml--2">
												<div class="d-flex justify-content-between align-items-center">
													<div>
														<h4 class="mb-0 text-sm">John Snow</h4>
													</div>
													<div class="text-right text-muted">
														<small>2 hrs ago</small>
													</div>
												</div>
												<p class="text-sm mb-0">Let's meet at Starbucks at 11:30. Wdyt?</p>
											</div>
										</div>
									</a>
								<!-- View all --
								<a href="#!" class="dropdown-item text-center text-primary font-weight-bold py-3">View all</a>
							</div>
						</li>
						<li class="nav-item dropdown">
							<a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								<i class="ni ni-ungroup"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-lg dropdown-menu-dark bg-default    dropdown-menu-right ">
								<div class="row shortcuts px-4">
									<a href="#!" class="col-4 shortcut-item">
										<span class="shortcut-media avatar rounded-circle bg-gradient-red">
											<i class="ni ni-calendar-grid-58"></i>
										</span>
										<small>Calendar</small>
									</a>
									<a href="#!" class="col-4 shortcut-item">
										<span class="shortcut-media avatar rounded-circle bg-gradient-orange">
											<i class="ni ni-email-83"></i>
										</span>
										<small>Email</small>
									</a>
									<a href="#!" class="col-4 shortcut-item">
										<span class="shortcut-media avatar rounded-circle bg-gradient-info">
											<i class="ni ni-credit-card"></i>
										</span>
										<small>Payments</small>
									</a>
									<a href="#!" class="col-4 shortcut-item">
										<span class="shortcut-media avatar rounded-circle bg-gradient-green">
											<i class="ni ni-books"></i>
										</span>
										<small>Reports</small>
									</a>
									<a href="#!" class="col-4 shortcut-item">
										<span class="shortcut-media avatar rounded-circle bg-gradient-purple">
											<i class="ni ni-pin-3"></i>
										</span>
										<small>Maps</small>
									</a>
									<a href="#!" class="col-4 shortcut-item">
										<span class="shortcut-media avatar rounded-circle bg-gradient-yellow">
											<i class="ni ni-basket"></i>
										</span>
										<small>Shop</small>
									</a>
								</div>
							</div>
						</li> -->
					</ul>
					<ul class="navbar-nav align-items-center ml-0">
						<li class="nav-item dropdown">
							<a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="false">
								<div class="media align-items-center">
									<span class="avatar avatar avatar-sm text-right rounded-circle">
										<img id="navProfilePictureImg" alt="" src="">
									</span>
									<div class="media-body ml-2 d-none d-lg-block">
										<span id="navProfileUsername"
											class="mb-0 text-sm font-weight-bold text-secondary"></span>
									</div>
								</div>
							</a>
							<div class="dropdown-menu dropdown-menu-right bg-darkish">
								<!-- <div class="dropdown-header noti-title">
									<h6 class="text-overflow m-0 text-secondary"></h6>
								</div> -->
								<a id="myprofile" href="#profile" class="dropdown-item text-dropdown">
									<i id="myprofileicon" class="ni ni-single-02"></i>
									<span>My profile</span>
								</a>
								<!-- <a href="#!" class="dropdown-item">
									<i class="ni ni-settings-gear-65"></i>
									<span>Settings</span>
								</a> -->
								<div class="py-1"></div>
								<a id="logout" href="javascript: skyid.sessionDestroy('index.html');"
									class="dropdown-item text-dropdown">
									<i id="logouticon" class="ni ni-button-power"></i>
									<span>Logout</span>
								</a>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<!-- Header -->
		<!-- Header -->
		<div class="header bg-darkish pb-6">
			<div class="separator separator-bottom separator-skew zindex-100">
				<svg x="0" y="0" viewBox="0 0 2560 100" preserveAspectRatio="none" version="1.1"
					xmlns="http://www.w3.org/2000/svg">
					<polygon class="fill-dark" points="2560 0 2560 100 0 100"></polygon>
				</svg>
			</div>
			<div class="container-fluid">
				<div class="header-body">
				</div>
			</div>
		</div>
		<!-- Page content -->
		<div class="container-fluid mt--6" id="content">
			Loading...
			<!-- Footer -->
			<!-- <footer class="footer pt-0">
				<div class="row align-items-center justify-content-lg-between">
					<div class="col-lg-6">
						<div class="copyright text-center    text-lg-left    text-muted">
							&copy; 2020 <a href="https://www.creative-tim.com" class="font-weight-bold ml-1" target="_blank">Creative Tim</a>
						</div>
					</div>
					<div class="col-lg-6">
						<ul class="nav nav-footer justify-content-center justify-content-lg-end">
							<li class="nav-item">
								<a href="https://www.creative-tim.com" class="nav-link" target="_blank">Creative Tim</a>
							</li>
							<li class="nav-item">
								<a href="https://www.creative-tim.com/presentation" class="nav-link" target="_blank">About Us</a>
							</li>
							<li class="nav-item">
								<a href="http://blog.creative-tim.com" class="nav-link" target="_blank">Blog</a>
							</li>
							<li class="nav-item">
								<a href="https://github.com/creativetimofficial/argon-dashboard/blob/master/LICENSE.md" class="nav-link" target="_blank">MIT License</a>
							</li>
						</ul>
					</div>
				</div>
			</footer> -->
		</div>
	</div>
	<!-- Argon Scripts -->
	<!-- Core -->

	<script src="skyid.js"></script>
	<script src="assets/vendor/jquery/dist/jquery.min.js"></script>
	<script>
		if (window.location.hostname == 'idtest.local' || window.location.hostname == 'localhost' || window.location.protocol == 'file:') {
			var skyid = new SkyID('SkyID', false, { 'devMode': true, 'customSkyidUrl': 'https://idtest.local' })
		} else {
			var skyid = new SkyID('SkyID')
		}

		if (skyid.seed == '') {
			window.location.href = 'index.html'
		}
	</script>

	<script src="assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script src="assets/vendor/js-cookie/js.cookie.js"></script>
	<script src="assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
	<script src="assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>
	<!-- Optional JS -->
	<script src="assets/vendor/chart.js/dist/Chart.min.js"></script>
	<script src="assets/vendor/chart.js/dist/Chart.extension.js"></script>
	<!-- Argon JS -->
	<script src="assets/js/argon.js?v=1.2.0"></script>
	<script type="text/javascript" src="assets/js/browser-image-compression.js"></script>
	<!-- qrcode.js -->
	<script src="assets/js/qrcode.min.js"></script>


	<script>

		window.addEventListener("hashchange", function () {
			loadPage(window.location.hash)
		})

		loadPage(window.location.hash || '#profile')

		var qrCode;

		var currentpage = window.location.hash
		function loadPage(page) {
			if (currentpage == page) {
				return
			}
			currentpage = page
			if (history.pushState) {
				history.pushState(null, null, page);
			}
			else {
				location.hash = page;
			}
			if (page == '#dapps') {
				var content = `<div class="card bg-dark">
						<!-- Card header -->
						<div class="card-header border-0 bg-dark">
							<h3 class="mb-0 text-white">Connected dapps</h3>
						</div>
						<!-- Light table -->
						<div class="table-responsive">
							<table class="table align-items-center table-flush">
								<thead class="bg-dark text-secondary">
									<tr>
										<th scope="col" class="sort" data-sort="name">Dapp</th>
										<th scope="col" class="sort" data-sort="budget">Url</th>
										<th scope="col" class="sort" data-sort="status">Public key</th>
										<th scope="col"></th>
									</tr>
								</thead>
								<tbody class="list" id="dappsTable">

								</tbody>
							</table>
						</div>
					</div>`
			} else if (page == "#qr-login") {
				var content = `<div class="wrapper">
					<div class="row-auto d-flex justify-content-center align-items-stretch">
						<div class="col-auto pt-0 order-xl-1">
							<div class="card bg-darkish">
								<div class="card-header bg-darkish">
									<div class="row align-items-center">
										<div class="col-auto">
											<h3 class="mb-0 text-secondary">Login with QR-Code</h3>
										</div>
									</div>
									</div>
										<div class="card-body bg-dark">
											<div class="bg-dark mx-2 pb-5 rounded">
											<label class="form-control-label text-light" for="qr-app">Enter Skapp name:</label>
										<input type="text" id="qr-app" oninput="updateQRCode()" class="form-control text-secondary bg-grayish" autofocus>
										<br>
										<div id="qrcode"></div>
										</div>
</div>
				</div>
				</div>
						</div>
				</div>`
			} else if (page == "#stats") {
				content = `<div class="row">
				<div class="col-lg-8">
					<div class="card bg-default">
						<div class="card-header bg-transparent">
							<div class="row align-items-center">
								<div class="col">
									<h6 class="text-light text-uppercase ls-1 mb-1">Overview</h6>
									<h5 class="h3 text-white mb-0">Sales value</h5>
								</div>
								<div class="col">
									<ul class="nav nav-pills justify-content-end">
										<li class="nav-item mr-2 mr-md-0" data-toggle="chart" data-target="#chart-sales-dark" data-update='{"data":{"datasets":[{"data":[0, 20, 10, 30, 15, 40, 20, 60, 60]}]}}' data-prefix="$" data-suffix="k">
											<a href="#" class="nav-link py-2 px-3 active" data-toggle="tab">
												<span class="d-none d-md-block">Month</span>
												<span class="d-md-none">M</span>
											</a>
										</li>
										<li class="nav-item" data-toggle="chart" data-target="#chart-sales-dark" data-update='{"data":{"datasets":[{"data":[0, 20, 5, 25, 10, 30, 15, 40, 40]}]}}' data-prefix="$" data-suffix="k">
											<a href="#" class="nav-link py-2 px-3" data-toggle="tab">
												<span class="d-none d-md-block">Week</span>
												<span class="d-md-none">W</span>
											</a>
										</li>
									</ul>
								</div>
							</div>
						</div>
						<div class="card-body">
							<!-- Chart -->
							<div class="chart">
								<!-- Chart wrapper -->
								<canvas id="chart-sales-dark" class="chart-canvas"></canvas>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-4">
					<div class="card">
						<div class="card-header bg-transparent">
							<div class="row align-items-center">
								<div class="col">
									<h6 class="text-uppercase text-muted ls-1 mb-1">Performance</h6>
									<h5 class="h3 mb-0">Total orders</h5>
								</div>
							</div>
						</div>
						<div class="card-body">
							<!-- Chart -->
							<div class="chart">
								<canvas id="chart-bars" class="chart-canvas"></canvas>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-8">
					<div class="card">
						<div class="card-header border-0">
							<div class="row align-items-center">
								<div class="col">
									<h3 class="mb-0">Page visits</h3>
								</div>
								<div class="col text-right">
									<a href="#!" class="btn btn-sm btn-primary">See all</a>
								</div>
							</div>
						</div>
						<div class="table-responsive">
							<!-- Projects table -->
							<table class="table align-items-center table-flush">
								<thead class="thead-light">
									<tr>
										<th scope="col">Page name</th>
										<th scope="col">Visitors</th>
										<th scope="col">Unique users</th>
										<th scope="col">Bounce rate</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<th scope="row">
											/argon/
										</th>
										<td>
											4,569
										</td>
										<td>
											340
										</td>
										<td>
											<i class="fas fa-arrow-up text-success mr-3"></i> 46,53%
										</td>
									</tr>
									<tr>
										<th scope="row">
											/argon/index.html
										</th>
										<td>
											3,985
										</td>
										<td>
											319
										</td>
										<td>
											<i class="fas fa-arrow-down text-warning mr-3"></i> 46,53%
										</td>
									</tr>
									<tr>
										<th scope="row">
											/argon/charts.html
										</th>
										<td>
											3,513
										</td>
										<td>
											294
										</td>
										<td>
											<i class="fas fa-arrow-down text-warning mr-3"></i> 36,49%
										</td>
									</tr>
									<tr>
										<th scope="row">
											/argon/tables.html
										</th>
										<td>
											2,050
										</td>
										<td>
											147
										</td>
										<td>
											<i class="fas fa-arrow-up text-success mr-3"></i> 50,87%
										</td>
									</tr>
									<tr>
										<th scope="row">
											/argon/profile.html
										</th>
										<td>
											1,795
										</td>
										<td>
											190
										</td>
										<td>
											<i class="fas fa-arrow-down text-danger mr-3"></i> 46,53%
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="col-lg-4">
					<div class="card">
						<div class="card-header border-0">
							<div class="row align-items-center">
								<div class="col">
									<h3 class="mb-0">Social traffic</h3>
								</div>
								<div class="col text-right">
									<a href="#!" class="btn btn-sm btn-primary">See all</a>
								</div>
							</div>
						</div>
						<div class="table-responsive">
							<!-- Projects table -->
							<table class="table align-items-center table-flush">
								<thead class="thead-light">
									<tr>
										<th scope="col">Referral</th>
										<th scope="col">Visitors</th>
										<th scope="col"></th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<th scope="row">
											Facebook
										</th>
										<td>
											1,480
										</td>
										<td>
											<div class="d-flex align-items-center">
												<span class="mr-2">60%</span>
												<div>
													<div class="progress">
														<div class="progress-bar bg-gradient-danger" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;"></div>
													</div>
												</div>
											</div>
										</td>
									</tr>
									<tr>
										<th scope="row">
											Facebook
										</th>
										<td>
											5,480
										</td>
										<td>
											<div class="d-flex align-items-center">
												<span class="mr-2">70%</span>
												<div>
													<div class="progress">
														<div class="progress-bar bg-gradient-success" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width: 70%;"></div>
													</div>
												</div>
											</div>
										</td>
									</tr>
									<tr>
										<th scope="row">
											Google
										</th>
										<td>
											4,807
										</td>
										<td>
											<div class="d-flex align-items-center">
												<span class="mr-2">80%</span>
												<div>
													<div class="progress">
														<div class="progress-bar bg-gradient-primary" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%;"></div>
													</div>
												</div>
											</div>
										</td>
									</tr>
									<tr>
										<th scope="row">
											Instagram
										</th>
										<td>
											3,678
										</td>
										<td>
											<div class="d-flex align-items-center">
												<span class="mr-2">75%</span>
												<div>
													<div class="progress">
														<div class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%;"></div>
													</div>
												</div>
											</div>
										</td>
									</tr>
									<tr>
										<th scope="row">
											twitter
										</th>
										<td>
											2,645
										</td>
										<td>
											<div class="d-flex align-items-center">
												<span class="mr-2">30%</span>
												<div>
													<div class="progress">
														<div class="progress-bar bg-gradient-warning" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100" style="width: 30%;"></div>
													</div>
												</div>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>`
			} else if (page == '#profile') {
				var content = `<div class="wrapper">
					<div class="row-auto d-flex justify-content-center align-items-stretch">
						<!--<div class="col-lg-4 order-xl-2">
						<div class="card card-profile">
							<img src="assets/img/theme/img-1-1000x600.jpg" alt="Image placeholder" class="card-img-top">
							<div class="row justify-content-center">
								<div class="col-lg-3 order-lg-2">
									<div class="card-profile-image">
										<a href="#">
											<img src="assets/img/theme/team-4.jpg" class="rounded-circle">
										</a>
									</div>
								</div>
							</div>
							<div class="card-header text-center border-0 pt-8 pt-md-4 pb-0 pb-md-4">
								<div class="d-flex justify-content-between">
									<a href="#" class="btn btn-sm btn-info    mr-4 ">Connect</a>
									<a href="#" class="btn btn-sm btn-default float-right">Message</a>
								</div>
							</div>
							<div class="card-body pt-0">
								<div class="row">
									<div class="col">
										<div class="card-profile-stats d-flex justify-content-center">
											<div>
												<span class="heading">22</span>
												<span class="description">Friends</span>
											</div>
											<div>
												<span class="heading">10</span>
												<span class="description">Photos</span>
											</div>
											<div>
												<span class="heading">89</span>
												<span class="description">Comments</span>
											</div>
										</div>
									</div>
								</div>
								<div class="text-center">
									<h5 class="h3">
										Jessica Jones<span class="font-weight-light">, 27</span>
									</h5>
									<div class="h5 font-weight-300">
										<i class="ni location_pin mr-2"></i>Bucharest, Romania
									</div>
									<div class="h5 mt-4">
										<i class="ni business_briefcase-24 mr-2"></i>Solution Manager - Creative Tim Officer
									</div>
									<div>
										<i class="ni education_hat mr-2"></i>University of Computer Science
									</div>
								</div>
							</div>
						 </div>
					</div> --!>
					<div class="col-sm-12 order-xl-1">
						<div class="card bg-darkish">
							<div class="card-header bg-darkish">
								<div class="row align-items-center">
									<div class="col-8">
										<h3 id="profileTitle" class="mb-0 text-secondary">Profile</h3>
									</div>
									<div class="col-4 text-right">

										<a id="edit" title="Edit profile" href="javascript: editProfile()" class="btn btn-dark">Edit</a>
										<a id="undo" title="Undo changes" href="javascript: undoEdit()" class="btn btn-dark" style="display:none;">Undo</a>
									</div>
								</div>
							</div>
							<div class="card-body pt-0 text-center">
								<form>
									<div id="profileCard" class="bg-dark mx-2 pb-5 rounded">
									<h6 id="psa" style="display:none;" class="heading-small text-secondary mb-4">Public information</h6>
									<div class="p-auto">
										<div class="row-auto">
											<div class="col-auto">
												<div class="form-group">
													<label id="avatarLabel" style="display: none;" class="form-control-label text-light" for="profilePicture">Avatar</label>
													<div id="avatarPosition" class="profilePictureInput card-profile-image">
														<a id="profPictLink" target="_blank">
															<label>
																<img id="profilePictureImg" alt="">
																<input type="file" id="profilePicture" accept="image/*" class="file-upload__input">
															</label>
															</a>
													</div>
													<div class="d-flex justify-content-center">
														<a style="display: none;" id="generateAvatarBtn" href="javascript: generateRandomAvatar()" class="btn btn-sm btn-dark">generate random avatar</a>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="p-auto">
										<div class="row-auto">
											<div class="col-auto">
												<div class="form-group">
													<label id="usernameLabel" style="display: none;" class="form-control-label text-light" for="profileUsername">Username</label>
													<h3 id="profileUsernameDiv" class="text-secondary pt-4"></h3>
												</div>
											</div>
										</div>
									</div>
									<div class="p-auto">
										<div class="row-auto">
											<div class="col-auto">
										<div class="form-group">
											<label id="aboutMeLabel" style="display: none;" class="form-control-label text-light">About Me</label>
											<div id="profileAboutMeDiv" class="h5 text-secondary"></div>
										</div>
									</div>
								</div>
											</div>
									<div class="p-auto">
										<div class="row-auto">
											<div class="col-auto">
												<div class="form-group">
													<label id="locationLabel" style="display: none;" class="form-control-label text-light" for="profileLocation">Location</label>
													<div type="text" id="profileLocationDiv" class="h5 font-weight-300 text-secondary" placeholder="Location"></div>

												</div>
											</div>
										</div>
									</div>

									<!-- <hr class="my-4" /> -->
									<!-- Description -->
									<!-- <h6 class="heading-small text-secondary mb-4">Private informations</h6> -->
									<div class="p-auto">
										<div class="row-auto">
											<div class="col-auto">
												<div class="form-group">
									<a id="save" title="Save profile" type="submit" href="javascript: saveProfile()" class="btn btn-skygreenish float-right" style="display: none;">Save</a>
								</div>
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
						<div class="card-footer bg-darkish">
								<div class="row-auto">
									<div class="col-auto text-right">
										<button type="submit" id="save2" title="Save profile" href="javascript: saveProfile()" class="btn btn-skygreenish" style="display: none;">Save</button>
									</div>
								</div>
							</div>
					</div>
				</div>`
			} else if (page == "#blog") {
				var content = `
				<div class="wrapper">
					<div class="row-auto d-flex justify-content-stretch align-items-center">
						<div class="col-sm-12 order-xl-1">
							<div class="card" style="min-width:60vw;">
								<div class="card-header bg-darkish">
									<div class="row align-items-center">
										<div class="col-8">
											<h3 class="mb-0 text-secondary">Blog</h3>
										</div>
										<div class="col-4 text-right">
											<!-- <a href="#!" class="btn btn-sm btn-primary">Settings</a> -->
											<small class="float-right text-light">More content coming soon</small>
										</div>
									</div>
								</div>
								<div class="card-body pb-5 bg-darkish">

									<div class="bg-dark mx-2 p-4 rounded">
										<a href="https://sky-note.hns.siasky.net/" target="_blank">
											<h2 class="text-light">Example dapp using SkyID</h2>
										</a>
										<a href="https://github.com/DaWe35" class="skygreenish" target="_blank">by DaWe</a>
										<br><br>

										<a href="https://blog.sia.tech/skyid-how-to-make-decentralized-identity-using-skynet-2b282682f5b3" target="_blank">
											<h2 class="text-light">How to Make Decentralized Identity using Skynet</h2>
										</a>
										<a href="https://medium.com/@davidvorick" class="skygreenish" target="_blank">by David Vorick</a>
									</div>

								</div>
							</div>
						</div>
					</div>
				</div>
				`
			}
			document.getElementById('content').innerHTML = content
			if (page == '#profile') {
				fetchProfile(),
					updateAvatar()
			} else if (page == '#dapps') {
				fetchDapps()
			} else if (page == '#qr-login') {
				qrCode =
					new QRCode(document.getElementById("qrcode"), {
						text: "",
						correctLevel: QRCode.CorrectLevel.L
					});

				document.getElementById('qr-app').focus();


			}
		}

		function fetchDapps() {
			var table = document.getElementById('dappsTable')

			// fetch file
			skyid.getFile('profile', function (response, revision) {
				if (response == '') { // file not found
					table.innerHTML = ''
				} else { // success
					var respObs = JSON.parse(response)
					var rows = ''
					for (var key in respObs.dapps) {
						// skip loop if the property is from prototype
						if (!respObs.dapps.hasOwnProperty(key)) continue
						var dataRow = respObs.dapps[key]

						rows += `
							<tr class="text-light">
								<th scope="row">
									<a href="` + dataRow.url + `" class="text-white" target="_blank">
										<div class="media align-items-center">
											<div class="avatar rounded-circle mr-3">
												<img alt="Image placeholder" src="assets/img/brand/SkyID_Logo_128.png">
											</div>
											<div class="media-body">
												<span class="name mb-0 text-sm">` + key + `</span>
											</div>
										</div>
									</a>
								</th>
								<td class="budget"> ` +
							dataRow.url + `
								</td>
								<td class="budget"> ` +
							dataRow.publicKey + `
								</td>
								<td class="text-right">
									<div class="dropdown">
										<a class="btn btn-sm btn-icon-only text-light" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
											<i class="fas fa-ellipsis-v"></i>
										</a>
										<div class="dropdown-menu dropdown-menu-right dropdown-menu-arrow">
											<a class="dropdown-item" href="javascript:alert('soon')">soon</a>
										</div>
									</div>
								</td>
							</tr>`
					}
					if (rows == '') {
						rows += `<tr class="text-light">
								<th scope="row">There are no connected dapps. <a class="text-skygreenish" href="https://sky-note.hns.siasky.net/" target="_blank">Try out this example!</a></th>
								<td class="budget"></td>
								<td class="budget"></td>
								<td class="text-right"></td>
							</tr>`
					}
					table.innerHTML = rows
				}
			})
		}

		function fetchProfile() {
			var profileUsernameDiv = document.getElementById('profileUsernameDiv')
			var profileAboutMeDiv = document.getElementById('profileAboutMeDiv')
			var profileLocationDiv = document.getElementById('profileLocationDiv')
			var profilePictureImg = document.getElementById('profilePictureImg')
			var profPictLink = document.getElementById('profPictLink')
			var navProfilePictureImg = document.getElementById('navProfilePictureImg')

			// fetch file
			skyid.getFile('profile', function (response, revision) {
				if (response == '') { // file not found
					alert('Profile not found, please check your connection and retry')
				} else { // success
					var respObs = JSON.parse(response)
					navProfileUsername.innerHTML = profileUsernameDiv.innerHTML = respObs.username
					profileAboutMeDiv.innerHTML = respObs.aboutMe
					profileLocationDiv.innerHTML = respObs.location || ''
					console.log('Profile data:', respObs)
					if (typeof respObs.avatar != 'undefined') {
						navProfilePictureImg.src = profilePictureImg.src = getProfPictUrl(respObs.avatar, 50)
						profPictLink.href = getProfPictUrl(respObs.avatar, 1920)
					}
					else {
						navProfilePictureImg.src = profilePictureImg.src = "https://avatars.dicebear.com/api/avataaars/" + (new Date).getTime() + ".svg"


					}

				}
			})
		}

		function getProfPictUrl(skyfile, size) {
			if (skyid.opts != null && skyid.opts.devMode != null && skyid.opts.devMode == true) {
				return 'https://siasky.net/' + skyfile + '/' + size
			} else {
				return '/' + skyfile + '/' + size
			}
		}

		async function handleImageUpload(callback) {
			skyid.showOverlay()
			const imageFile = document.getElementById("profilePicture").files[0];
			console.log(`originalFile size ${imageFile.size / 1024 / 1024} MB`);
			var profilePicture = []

			const sizes = [50, 150, 300, 600, 1920]
			const maxMB = [0.01, 0.06, 0.2, 0.6, 3]
			for (let i = 0; i < sizes.length; i++) {
				const options = {
					maxSizeMB: maxMB[i],
					maxWidthOrHeight: sizes[i],
					useWebWorker: true
				}
				try {
					const compressedFile = await imageCompression(imageFile, options);
					console.log(`compressedFile size ${compressedFile.size / 1024 / 1024} MB`); // smaller than maxSizeMB
					compressedFile.name = String(sizes[i])
					profilePicture.push(compressedFile)
				} catch (error) {
					console.log(error)
					alert('Failed to compress profile picture (size:', sizes[i], 'px')
				}
			}
			console.log('profilePicture', profilePicture)
			skyid.uploadDirectory(profilePicture, function (skylink) {
				if (skylink.startsWith('sia:')) {
					var skyfile = skylink.substring(4)
				} else {
					var skyfile = skylink
				}
				console.log('skylink from uploadDirectory', skyfile)
				callback(skyfile)
			})
		}



		function saveProfile() {

			if (document.getElementById("profilePicture").files.length == 0) {
				saveProfileJson()
			} else {
				var profilePictureSkylink = handleImageUpload(saveProfileJson);
			}

			$('#profileCard').addClass('bg-dark pb-5 rounded')
			$('#avatarPosition').addClass('card-profile-image')

			$('#save').hide()
			$('#save2').hide()

			$('#profileTitle').empty().html("Profile")

			$('#profileLocation').each(function () {
				var content = $(this).val()//.replace(/\n/g,"<br>")
				$('#profileLocationDiv').empty()
				$('#profileLocationDiv').html(content)
				$(this).hide()

			})
			$('#profileUsername').each(function () {
				let content = $(this).val()//.replace(/\n/g,"<br>")
				$('#profileUsernameDiv').empty()
				$('#profileUsernameDiv').html(content)
				$(this).hide()
			})
			$('#profileAboutMe').each(function () {
				let content = $(this).val()//.replace(/\n/g,"<br>")
				$('#profileAboutMeDiv').empty()
				$('#profileAboutMeDiv').html(content)
				$(this).hide()
			})



			$('#avatarLabel').css('display', 'none')

			$('#usernameLabel').css('display', 'none')

			$('#aboutMeLabel').css('display', 'none')

			$('#locationLabel').css('display', 'none')

			$('#psa').css('display', 'none')


			$('#generateAvatarBtn').hide()
			$('#undo').hide()
			$('#edit').show()

		}




		function saveProfileJson(profilePicture = false) {

			let username = document.getElementById('profileUsername').value
			let aboutMe = document.getElementById('profileAboutMe').value
			let location = document.getElementById('profileLocation').value

			skyid.getFile('profile', function (response, revision) {
				if (response == '') { // file not found
					alert('Error: unable to fetch your profile')
					console.log('Error: unable to fetch your profile')
				} else { // success
					var profileObj = JSON.parse(response)
					profileObj.username = username
					profileObj.aboutMe = aboutMe
					profileObj.location = location
					if (profilePicture != false) {
						profileObj.avatar = profilePicture
					}
					// set file
					let jsonProfile = JSON.stringify(profileObj)
					skyid.setFile('profile', jsonProfile, function (success) {
						if (!success) {
							alert('Error: unable to save profile')

						}
						if (profilePicture != false) {
							let profilePictureImg = document.getElementById('profilePictureImg')
							let profPictLink = document.getElementById('profPictLink')
							profilePictureImg.src = getProfPictUrl(profilePicture, 50)
							profPictLink.href = getProfPictUrl(profilePicture, 1920)

							document.getElementById("profilePicture").value = ""
						}
					})
				}
			})
		}

		function updateQRCode() {
			let input = document.getElementById('qr-app');
			var { postMessage, publicAppData } = skyid.makeLoginSuccessPayload(input.value, 'QR login');
			qrCode.makeCode(JSON.stringify(postMessage)); // make another code.
		}

		//instant visual feedback when switching avatars
		function updateAvatar() {
			var profilePictureImg = $("#profilePictureImg"),
				profilePicture = $("#profilePicture")
			profilePicture.change(function () {

				if (this.files && this.files[0]) {
					var reader = new FileReader()

					reader.onload = function (e) {
						profilePictureImg.attr("src", e.target.result)
					}

					reader.readAsDataURL(this.files[0])
					$('#save2').show()
				}

			})
		}

		function editProfile() {

			$('#profileCard').removeClass('bg-dark pb-5 rounded')
			$('#avatarPosition').removeClass('card-profile-image')

			$('#edit').hide()
			$('#undo').show()

			$('#save2').hide()
			$('#generateAvatarBtn').show()

			$('#profileTitle').empty().html("Edit profile")

			$('#psa').css({ 'display': 'block' })

			$('#avatarLabel').css({ 'display': 'block' })

			$('#usernameLabel').css({ 'display': 'block', 'float': 'left' })

			$('#aboutMeLabel').css({ 'display': 'block', 'float': 'left' })

			$('#locationLabel').css({ 'display': 'block', 'float': 'left' })


			$('#profileUsernameDiv').each(function () {
				var content1 = $(this).html()
				$(this).html('<input id="profileUsername" type="text" class="form-control text-secondary bg-dark" value="' + content1 + '">')
			})
			$('#profileAboutMeDiv').each(function () {
				var content2 = $(this).html()
				$(this).html('<textarea style="font-size: 16px" id="profileAboutMe" rows="4" class="form-control text-secondary bg-dark">' + content2 + '</textarea>')
			})
			$('#profileLocationDiv').each(function () {
				var content3 = $(this).html()
				$(this).html('<input type="text" id="profileLocation" class="form-control text-secondary bg-dark" value="' + content3 + '">')
			})

			$('#save').show()

		}

		function undoEdit() {

			$('#profileCard').addClass('bg-dark pb-5 rounded')
			$('#avatarPosition').addClass('card-profile-image')

			$('#undo').hide()
			$('#edit').show()

			$('#generateAvatarBtn').hide()

			$('#profileTitle').empty().html("Profile")

			$('#avatarLabel').css('display', 'none')

			$('#usernameLabel').css('display', 'none')

			$('#aboutMeLabel').css('display', 'none')

			$('#locationLabel').css('display', 'none')

			$('#psa').css('display', 'none')


			$('#profileUsernameDiv').empty()
			$('#profileAboutMeDiv').empty()
			$('#profileLocationDiv').empty()

			fetchProfile()

			$('#save').hide()
		}

		function generateRandomAvatar() {
			profilePictureImg.src = "https://avatars.dicebear.com/api/avataaars/" + (new Date).getTime() + ".svg"
		}

	</script>
</body>

</html>
